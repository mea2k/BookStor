# КОЛЛЕКЦИЯ КНИГ

## RESTful backend server (CRUD API)

### Описание

Сервер "Коллекция книг" предоставляет следующие возможности (API):
1. Авторизация пользователя (`POST /api/user/login`).
2. Получение списка хранимых книг (`GET /api/books`).
3. Получение информации об отдельной книге (`GET /api/books/:id`).
4. Добавление книги в коллекцию (`POST /api/books`).
5. Изменение информации о книге из коллекции (`PUT /api/books/:id`).
6. Удаление книги из коллекции (`DELETE /api/books/:id`).

Для реализации функционала сервера разработаны две сущности и методы для них: сущность *КНИГА* и сущность *КОЛЛЕКЦИЯ КНИГ*.

### Сущность "Книга" ([book.js](book.js))

Сущность "Книга" реализована в файле [book.js](book.js).

Атрибуты сущности:

`title` - название книги (`String`),

`description` - описание книги (`String`),

`authors` - авторы книги (`String`),

`favorite` - жанр книги (`String`),

`fileCover` - имя файла с картинкой обложки (`String`),

`fileName` - имя файла с текстом (`String`),

`id` - внутренний идентификатор книги (используется внутри системы, назначается автоматически)
 

 ### Сущность "Коллекция книг" ([bookStorage.js](bookStorage.js))

Сущность "Коллекция книг" реализована в файле [bookStorage.js](bookStorage.js).

Методы сущности:

`getAll()` - возвращает массив книг (`[]`)

`get(id)`  - возвращает информацию о конкретной книге с идентификатором `id` или `undefined`, если книга не найдена

`add(item)` - добавление книги `item` (объект класса Book) в хранимый массив и возвращает общее число книг или `-1`, если ошибка добавления

`modify(id, item)` - изменяет информацию о книге с идентификатором `id`. Новая информация представлена в объекте класса Book - `item`. Старый идентификатор книги сохраняется. Метод возвращает обновленную информацию книги или `undefined`, если книга с идентификатором `id` не найдена.

`delete(id)` - удаление книги с идентификатором `id`. Метод возвращает `1` в случае успешного удаления или `0` - в случае ошибки.



### Основной файл ([index.js](index.js))

Основной код сервера реализован в файле [index.js](index.js). Используется библиотека `Express` для запуска сервера. Все параметры передаются в теле запросов в виде JSON-объектов, результат работы методов - JSON-данные.

Обрабатываемые пути (URL):

`POST /api/user/login` - аутентификация ([код](index.js?plain=18#L28)). Возвращает объект `{id, mail}`. Код успеха - 201.

`GET /api/books` - получение списка книг ([код](index.js?plain=37#L47)). Возвращает массив объектов типа Book `[{...}, {...}, ...]`. Код успеха - 200.

`GET /api/books/:id` - получение информации о книге с идентификатором `id` ([код](index.js?plain=56#L66)). Возвращает объект типа Book. Код успеха - 200. Код ошибки - 404.

`POST /api/books` - добавление новой книги ([код](index.js?plain=82#L92)). В теле запроса должен быть JSON-объект со значениями параметров книги (`{title,description,authors,favorite,fileCover,fileName}`). Возвращает саму добавленную книгу - объект класса Book. Код успеха - 201. Код ошибки - 403.

`PUT /api/books/:id` - редактирование информации о книги с идентификатором `id` ([код](index.js?plain=126#L137)). В теле запроса должен быть JSON-объект с новыми значениями параметров книги (`{title,description,authors,favorite,fileCover,fileName}`). Возвращает измененную информацию о книге - объект класса Book. Код успеха - 200. Код ошибки - 404.

`DELETE /api/books/:id` - удаление книги с идентификатором `id` ([код](index.js?plain=169#L179)). Возвращает 'ok' или пусто. Код успеха - 200. Код ошибки - 404.





## Запуск сервера

Запуск в режиме отладки:
```
npm run watch
```

Запуск для работы:
```
npm start
```
